<!DOCTYPE html>
<html lang="en">

<head>
    <title>Data Tabel</title>

    <style>
        table,
        th {
            border: 2px solid black;
            padding: 5px;
            border-collapse: collapse;
        }
        /* td {
            border: 2px solid black;
            border-collapse: collapse;
        }

        td {
            padding: 5px;
        } */

        span {
            font-style: italic;
            background-color: yellow;
        }
    </style>
</head>

<body>
<center>
    <h3 id="formTitle"></h3>
    <form name="formPeserta" onsubmit="return handleFormSubmit(this)">
        <input type="hidden" name="mode" value="add">

        <table>
            <tr>
                Nama :
                <input type="text" name="name" required="required">
            </tr>
            <tr>
                Tanggal Lahir :
                <input type="date" name="ttl" required="required">
            </tr>
            <tr>
                Kota :
                <input type="text" name="city" required="required">
            </tr>
        </table>
    </form>

    <br>
    <br>

    <button onclick="resetForm()">DAFTAR</button>

    <br>
    <br>

    <button onclick="sortNamaAsc()">Nama &#8593</button>
    <button onclick="sortNamaDsc()">Nama &#8595</button>
    <button onclick="sortUsiaAsc()">Usia &#8593</button>
    <button onclick="sortUsiaDsc()">Usia &#8595</button>
    <button onclick="sortKotaAsc()">Kota &#8593</button>
    <button onclick="sortKotaDsc()">Kota &#8595</button>

    <br>
    <br>

    <table id="tabelDaftar">
        <tr>
            <th>Nama</th>
            <th>Tanggal Lahir</th>
            <th>Zodiak</th>
            <th>Usia</th>
            <th>Pensiun</th>
            <th>Kota</th>
            <th>Hapus</th>
        </tr>
    </table>



</center>

    <script>


            function resetForm() {

            let form = document.forms['formPeserta'];
            form.reset();
            form['mode'].value = 'add';

            }

            function handleFormSubmit(formObj) {

            let mode = formObj['mode'].value;
            let name = formObj['name'].value;
            let date = formObj['ttl'].value;
            let city = formObj['city'].value;

            let isSuccess = false;

            if (mode === 'add') {
                isSuccess = dataManagement.add(new Peserta(name, date, city));
            }

            if (isSuccess) {
                dataManagement.refreshTable();
            }

            return false;
            }

            function loadDataToForm(idPeserta) {

            let form = document.forms['formPeserta'];
            document.getElementById('formTitle').innerHTML = 'Ubah Data';

            let totalData = database.length;
            let foundIndex = null;


        class Peserta {
            constructor(name, date, city) {
                this.name = name;
                this.date = date;
                this.city = city;
            }
        }

        let database = [new Peserta('Budi', '12/01/1986', "Ambon"),
                        new Peserta('Deni', '24/09/1985', "Palu")];

        class DataManagement {

        constructor() {}

        add(peserta) {

            // memastikan parameter seusia dengan object peserta
            if (peserta instanceof Peserta === false) {
                alert('Object peserta tidak valid.');
                return false;
            }

            let totalData = database.length;
            let valid = true;

            // check apakah id peserta sudah pernah ada
            for (let i = 0; i < totalData; i++) {
                if (database[i].name === peserta.name) {
                    valid = false;
                    break;
                }
            }

            if (valid === false) {
                alert('Nama Peserta sudah ada, silahkan gunakan yang lain.');
                return false;
            }

            database.push(peserta);

            return true;
        }
    
            refreshTable() {

            // Find a <table> element with id="daftarPeserta":
            let tabelDaftarPeserta = document.getElementById('tabelDaftar');
            let rowNumber = 1;
            let totalData = database.length;

            // Clean up table
            let totalRows = tabelDaftarPeserta.rows.length;

            for (let i = 1; i < totalRows; i++) {
                // kenapa indexnya selalu satu
                // karena ketika row dihapus maka urutan index row akan bermodify atau ke reset kembali mulai dari 1
                tabelDaftarPeserta.deleteRow(1);
            }

            for (let i = 0; i < totalData; i++) {

                let peserta = database[i];

                // Create an empty <tr> element and add it to the 1st position of the table:
                let row = tabelDaftarPeserta.insertRow(rowNumber);

                // Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);
                var cell5 = row.insertCell(2);


                // Add some text to the new cells:
                cell1.innerHTML = peserta.name;
                cell2.innerHTML = peserta.date;
                cell3.innerHTML = "";
                cell4.innerHTML = "";
                cell5.innerHTML = "";
                cell6.innerHTML = peserta.city;
                cell7.innerHTML = "";


                rowNumber++;

            }

            }

        }

    }

            let dataManagement = new DataManagement();
            dataManagement.refreshTable();

    </script>

</body>

</html>
